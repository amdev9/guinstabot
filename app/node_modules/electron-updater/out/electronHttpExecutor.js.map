{
  "version": 3,
  "file": "electronHttpExecutor.js",
  "sourceRoot": "",
  "sources": [
    "../src/electronHttpExecutor.ts"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "import { net } from \"electron\"\nimport { ensureDir } from \"fs-extra-p\"\nimport BluebirdPromise from \"bluebird-lst-c\"\nimport * as path from \"path\"\nimport { HttpExecutor, DownloadOptions, dumpRequestOptions, configureRequestOptions } from \"electron-builder-http\"\nimport { parse as parseUrl } from \"url\"\nimport { CancellationToken } from \"electron-builder-http/out/CancellationToken\"\n\nexport class ElectronHttpExecutor extends HttpExecutor<Electron.RequestOptions, Electron.ClientRequest> {\n  async download(url: string, destination: string, options?: DownloadOptions | null): Promise<string> {\n    if (options == null || !options.skipDirCreation) {\n      await ensureDir(path.dirname(destination))\n    }\n\n    return await new BluebirdPromise<string>((resolve, reject) => {\n      const parsedUrl = parseUrl(url)\n\n      this.doDownload(configureRequestOptions({\n        protocol: parsedUrl.protocol,\n        hostname: parsedUrl.hostname,\n        path: parsedUrl.path,\n        port: parsedUrl.port ? parseInt(parsedUrl.port, 10) : undefined,\n        headers: (options == null ? null : options.headers) || undefined,\n      }), destination, 0, options || {cancellationToken: new CancellationToken()}, (error: Error) => {\n        if (error == null) {\n          resolve(destination)\n        }\n        else {\n          reject(error)\n        }\n      })\n    })\n  }\n\n  doApiRequest<T>(options: Electron.RequestOptions, cancellationToken: CancellationToken, requestProcessor: (request: Electron.ClientRequest, reject: (error: Error) => void) => void, redirectCount: number = 0): Promise<T> {\n    if (<any>options.Protocol != null) {\n      // electron typings defines it as incorrect Protocol (uppercase P)\n      (<any>options).protocol = options.Protocol\n    }\n\n    if (this.debug.enabled) {\n      this.debug(`request: ${dumpRequestOptions(options)}`)\n    }\n\n    return cancellationToken.trackPromise(new BluebirdPromise<T>((resolve, reject, onCancel) => {\n      const request = net.request(options, response => {\n        try {\n          this.handleResponse(response, options, cancellationToken, resolve, reject, redirectCount, requestProcessor)\n        }\n        catch (e) {\n          reject(e)\n        }\n      })\n      this.addTimeOutHandler(request, reject)\n      request.on(\"error\", reject)\n      requestProcessor(request, reject)\n      onCancel!(() => request.abort())\n    }))\n  }\n\n\n  protected doRequest(options: any, callback: (response: any) => void): any {\n    return net.request(options, callback)\n  }\n}"
  ]
}
